var mvvmsample;(function(n){var t=function(){function t(){}return t.prototype.Start=function(){var t=new n.Window,r,l,u,f,e,a,o,i,s,h,c;t.Render();t.Start();r=new n.HomePage(this.Settings);l=new n.ProductsPage(this.Settings);t.Frame.Show(r);u=t.Ribbon.AddNewGroup();f=new n.AppCommand("Home","home");f.Action=function(){t.Frame.Show(r)};u.AddCommand(f);e=new n.AppCommand("Products","products");e.Action=function(){t.Frame.Show(l)};u.AddCommand(e);a=t.Ribbon.AddNewGroup();o=new n.AppCommand("Refresh","refresh");o.Action=function(){var n=t.Frame.View,i;n.CanRefresh?(i=n,i.Refresh()):alert("現在の表示では Refresh は実行出来ません")};a.AddCommand(o);i=t.Ribbon.AddNewGroup();s=new n.AppCommand("New Item","newItem");s.Action=function(){var n=t.Frame.View,i;n.CanAddNewItem?(i=n,i.AddNewItem()):alert("現在の表示では New Item は実行出来ません")};i.AddCommand(s);h=new n.AppCommand("Edit Item","editItem");h.Action=function(){var n=t.Frame.View,i;n.CanEditItem?(i=n,i.EditItem()):alert("現在の表示では Edit Item は実行出来ません")};i.AddCommand(h);c=new n.AppCommand("Delete Item","deleteItem");c.Action=function(){var n=t.Frame.View,i;n.CanDeleteItem?(i=n,i.DeleteItem()):alert("現在の表示では Delete Item は実行出来ません")};i.AddCommand(c)},t}();n.App=t})(mvvmsample||(mvvmsample={})),function(n){var t=function(){function n(n,t,i){this.backtoPage=t;this.settings=i;this.product=n;this.product||(this.product={Id:"",Title:"",ProductUrl:"",DownloadUrl:"",Description:"",Publisher:"",PublisherUrl:"",ImageUrl:"",Price:""})}return Object.defineProperty(n.prototype,"Parent",{get:function(){return this.parent},set:function(n){this.parent=n;this.Refresh()},enumerable:!0,configurable:!0}),n.prototype.Refresh=function(){var n=this,t;this.parent!=null&&(this.parent.ViewContainer.children().each(function(n,t){$(t).remove()}),this.parent.ViewContainer.append("<div class='editProductPage'><h1>Product Item<\/h1><input type='hidden' data-bind='value:Id' /><p>Title : <input type='text' data-bind='value:Title' /><\/p><p>ProductUrl : <input type='text' data-bind='value:ProductUrl' /><\/p><p>DownloadUrl : <input type='text' data-bind='value:DownloadUrl' /><\/p><p>Description : <input type='text' data-bind='value:Description' /><\/p><p>Publisher : <input type='text' data-bind='value:Publisher' /><\/p><p>PublisherUrl : <input type='text' data-bind='value:PublisherUrl' /><\/p><p>Price : <input type='text' data-bind='value:Price' /><\/p><p><input class='saveButton' type='button' value='Save' /><\/p><div>"),t={type:this.settings.PostOrGetForSaveProduct,url:this.settings.UriForSaveProduct,dataType:"json",timeout:1e4,success:function(t){var i,r;t.success?(i=n.Parent,i.Show&&i.Show(n.backtoPage),r=n.backtoPage,r.CanRefresh&&r.Refresh()):alert("error")},error:function(){alert("error")}},this.parent.ViewContainer.find(".saveButton").click(function(){t.data=n.product;$.ajax(t)}),ko.applyBindings(this.product,this.parent.ViewContainer.find(".editProductPage")[0]))},n}();n.EditProductPage=t}(mvvmsample||(mvvmsample={})),function(n){var o=function(){function n(){this.selector="#window";this.ribbon=new t(this,"ribbon");this.frame=new f(this,"frame")}return Object.defineProperty(n.prototype,"Container",{get:function(){return this.container},enumerable:!0,configurable:!0}),n.prototype.Render=function(){$("body").children().each(function(n,t){$(t).remove()});$("body").append('<div id="window"><\/div>');this.container=$(this.selector);this.ribbon.Render();this.frame.Render()},n.prototype.Start=function(){this.container=$(this.selector);this.ribbon.Start();this.frame.Start()},Object.defineProperty(n.prototype,"Ribbon",{get:function(){return this.ribbon},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Frame",{get:function(){return this.frame},enumerable:!0,configurable:!0}),n}(),t,i,r,e,u,f;n.Window=o;t=function(){function n(n,t){this.itemIdex=0;this.parent=n;this.id=t;this.selector="#"+t}return Object.defineProperty(n.prototype,"Container",{get:function(){return this.container},enumerable:!0,configurable:!0}),n.prototype.Render=function(){this.parent.Container.append("<nav id='"+this.id+"'><\/nav>")},n.prototype.Start=function(){this.container=this.parent.Container.find(this.selector)},n.prototype.AddNewGroup=function(){this.itemIdex+=1;var t="RibbonGroup"+this.itemIdex,n=new i(this,t);return n.Render(),n.Start(),n},n}();n.Ribbon=t;i=function(){function n(n,t){this.itemIdex=0;this.parent=n;this.id=t;this.selector="#"+t}return Object.defineProperty(n.prototype,"Container",{get:function(){return this.container},enumerable:!0,configurable:!0}),n.prototype.Render=function(){this.parent.Container.append("<ul id='"+this.id+"'><\/ul>")},n.prototype.Start=function(){this.container=this.parent.Container.find(this.selector)},n.prototype.AddCommand=function(n){this.itemIdex+=1;var i="AppComand"+this.itemIdex,t=new u(this,i,n);t.Render();t.Start()},n}();n.RibbonGroup=i;r=function(){function n(){}return n.Empty=new n,n}();n.EventArgs=r;e=function(){function n(n,t){this.text=n;this.icon=t}return Object.defineProperty(n.prototype,"Text",{get:function(){return this.text},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Icon",{get:function(){return this.icon},enumerable:!0,configurable:!0}),n.prototype.Invoke=function(){this.Action!=null&&this.Action(this,r.Empty)},n}();n.AppCommand=e;u=function(){function n(n,t,i){this.parent=n;this.command=i;this.id=t;this.selector="#"+t}return Object.defineProperty(n.prototype,"Container",{get:function(){return this.container},enumerable:!0,configurable:!0}),n.prototype.Render=function(){var n="";this.command.Icon!=null&&(n=this.command.Icon+"Button ");this.parent.Container.append("<li><a id='"+this.id+"' class='"+n+"linkButton' >"+this.command.Text+"<\/a><\/li>")},n.prototype.Start=function(){var n=this;this.container=this.parent.Container.find(this.selector);this.container.click(function(){n.command.Invoke()})},n}();n.RibbonButton=u;f=function(){function n(n,t){this.parent=n;this.id=t;this.selector="#"+t}return Object.defineProperty(n.prototype,"Container",{get:function(){return this.container},enumerable:!0,configurable:!0}),n.prototype.Render=function(){this.parent.Container.append("<article id='"+this.id+"'><\/article>")},n.prototype.Start=function(){this.container=this.parent.Container.find(this.selector);this.viewContainer=this.container},Object.defineProperty(n.prototype,"View",{get:function(){return this.view},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ViewContainer",{get:function(){return this.viewContainer},enumerable:!0,configurable:!0}),n.prototype.Show=function(n){this.viewContainer.children().each(function(n,t){$(t).remove()});this.view=n;n.Parent=this},n}();n.Frame=f}(mvvmsample||(mvvmsample={})),function(n){var t=function(){function n(n){this.settings=n}return Object.defineProperty(n.prototype,"Parent",{get:function(){return this.parent},set:function(n){this.parent=n;this.Refresh()},enumerable:!0,configurable:!0}),n.prototype.Refresh=function(){var t=this,n;this.parent!=null&&(this.parent.ViewContainer.children().each(function(n,t){$(t).remove()}),this.parent.ViewContainer.append("<div class='homePage'><h1>Home<\/h1><p data-bind='text:Description'><\/p><p data-bind='text:Version'><\/p><\/div>"),n=this.settings.UriForHome+"date="+(new Date).getTime(),$.getJSON(n).done(function(n){ko.applyBindings(n,t.parent.ViewContainer.find(".homePage")[0])}))},n}();n.HomePage=t}(mvvmsample||(mvvmsample={})),function(n){var t=function(){function n(n){this.product=n}return Object.defineProperty(n.prototype,"Parent",{get:function(){return this.parent},set:function(n){this.parent=n;this.Refresh()},enumerable:!0,configurable:!0}),n.prototype.Refresh=function(){this.parent!=null&&(this.parent.ViewContainer.children().each(function(n,t){$(t).remove()}),this.parent.ViewContainer.append("<div class='productPage'><h1>Product Item<\/h1><p>Title : <span data-bind='text:Title' /><\/p><p>Description : <span data-bind='text:Description' /><\/p><p>Publisher : <span data-bind='text:Publisher' /><\/p><p>Price : <span data-bind='text:Price' /><\/p><p><a target=\"_blank\" data-bind='attr: {href:DownloadUrl}'\">Download<\/a> <a target=\"_blank\" data-bind='attr: {href:ProductUrl}'\">Open Site<\/a> <a target=\"_blank\" data-bind='attr: {href:PublisherUrl}'\">Publisher<\/a> <\/p><div>"),ko.applyBindings(this.product,this.parent.ViewContainer.find(".productPage")[0]))},n}();n.ProductPage=t}(mvvmsample||(mvvmsample={})),function(n){var t=function(){function t(n){this.CanRefresh=!0;this.CanAddNewItem=!0;this.CanEditItem=!1;this.CanDeleteItem=!1;this.settings=n}return Object.defineProperty(t.prototype,"Parent",{get:function(){return this.parent},set:function(n){this.parent=n;this.RefreshView()},enumerable:!0,configurable:!0}),t.prototype.Refresh=function(){this.data=null;this.RefreshView()},t.prototype.AddNewItem=function(){var t=this.Parent;t.Show&&t.Show(new n.EditProductPage(null,this,this.settings))},t.prototype.EditItem=function(){},t.prototype.DeleteItem=function(){},t.prototype.RefreshView=function(){var t=this,i;this.parent!=null&&(this.parent.ViewContainer.children().each(function(n,t){$(t).remove()}),this.parent.ViewContainer.append("<div class='productsPage'><h1>Products<\/h1><table><thead><tr><th>Title<\/th><th>Description<\/th><th>Publisher<\/th><th>Price<\/th><\/tr><\/thead><tfoot><\/tfoot><tbody data-bind='foreach: lines'><tr data-bind='click: Clicked'><td class='nowrap' data-bind='text:Title'><\/td><td data-bind='text:Description'><\/td><td class='nowrap' data-bind='text:Publisher'><\/td><td class='nowrap' data-bind='text:Price'><\/td><\/tr><\/tbody><\/table><div>"),this.data?ko.applyBindings({lines:this.data},this.parent.ViewContainer.find(".productsPage")[0]):(i=this.settings.UriForProducts+"date="+(new Date).getTime(),$.getJSON(i).done(function(i){i.forEach(function(i,r,u){u[r].Clicked=function(){var f=u[r],i=t.Parent;i.Show&&i.Show(new n.ProductPage(f))}});t.data=i;ko.applyBindings({lines:i},t.parent.ViewContainer.find(".productsPage")[0])})))},t}();n.ProductsPage=t}(mvvmsample||(mvvmsample={})),function(n){var t=function(){function n(){}return n}();n.AppSettings=t}(mvvmsample||(mvvmsample={}))